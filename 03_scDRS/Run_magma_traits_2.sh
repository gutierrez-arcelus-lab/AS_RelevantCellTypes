#!/bin/bash
#SBATCH --job-name=run_magma_traits_2
#SBATCH --output=run_magma_traits_2_out_%a.txt
#SBATCH --error=run_magma_traits_2_err_%a.txt
#SBATCH --partition=bch-compute
#SBATCH --mail-type=BEGIN,END,FAIL
#SBATCH --mail-user=Marcos.ChinasHernandez@childrens.harvard.edu
#SBATCH --time=02:00:00
#SBATCH --mem=16G
#SBATCH --ntasks=1

source /programs/biogrids.shrc
awk -v OFS="\t" '$1=$1' ./magma_v1.10/out/step2/AS_ImmunoChip.genes.out > ./magma_v1.10/out/step2/AS_ImmunoChip_tab.genes.out;echo 'library(data.table);library(fs);library(tidyverse);args = commandArgs(trailingOnly=TRUE);pdir<-args[1];trait<-args[2];gene_loc_37 <- fread(fs::path(pdir,"NCBI37.3/NCBI37.3.gene.loc"), sep = "\t");colnames(gene_loc_37) <- c("entrezid", "chr", "start", "end","strand", "GN");magma_score_hg19 <- fread(fs::path(pdir,paste0("out/step2/",trait,"_tab.genes.out")), sep="\t", header = TRUE);magma_score_hg19_GN <- merge(gene_loc_37, magma_score_hg19, by.x = "entrezid", by.y = "GENE");scDRS_Input_magma <- magma_score_hg19_GN[,c("GN", "CHR", "START", "STOP", "NSNPS", "NPARAM", "N", "ZSTAT", "P")];fwrite(as_tibble(scDRS_Input_magma)%>%dplyr::select(GN,'AS_ImmunoChip'=ZSTAT),file = fs::path(pdir,"gs_file",paste0(trait,"_","scDRS_input_magma.tsv")),sep = "\t")' > ./magma_v1.10/Magma_entrez_to_symbol.R;export R_X=4.1;Rscript ./magma_v1.10/Magma_entrez_to_symbol.R ./magma_v1.10 AS_ImmunoChip
awk -v OFS="\t" '$1=$1' ./magma_v1.10/out/step2/AS_finngen.genes.out > ./magma_v1.10/out/step2/AS_finngen_tab.genes.out;echo 'library(data.table);library(fs);library(tidyverse);args = commandArgs(trailingOnly=TRUE);pdir<-args[1];trait<-args[2];gene_loc_37 <- fread(fs::path(pdir,"NCBI37.3/NCBI37.3.gene.loc"), sep = "\t");colnames(gene_loc_37) <- c("entrezid", "chr", "start", "end","strand", "GN");magma_score_hg19 <- fread(fs::path(pdir,paste0("out/step2/",trait,"_tab.genes.out")), sep="\t", header = TRUE);magma_score_hg19_GN <- merge(gene_loc_37, magma_score_hg19, by.x = "entrezid", by.y = "GENE");scDRS_Input_magma <- magma_score_hg19_GN[,c("GN", "CHR", "START", "STOP", "NSNPS", "NPARAM", "N", "ZSTAT", "P")];fwrite(as_tibble(scDRS_Input_magma)%>%dplyr::select(GN,'AS_finngen'=ZSTAT),file = fs::path(pdir,"gs_file",paste0(trait,"_","scDRS_input_magma.tsv")),sep = "\t")' > ./magma_v1.10/Magma_entrez_to_symbol.R;export R_X=4.1;Rscript ./magma_v1.10/Magma_entrez_to_symbol.R ./magma_v1.10 AS_finngen
awk -v OFS="\t" '$1=$1' ./magma_v1.10/out/step2/AS_finngen_strict.genes.out > ./magma_v1.10/out/step2/AS_finngen_strict_tab.genes.out;echo 'library(data.table);library(fs);library(tidyverse);args = commandArgs(trailingOnly=TRUE);pdir<-args[1];trait<-args[2];gene_loc_37 <- fread(fs::path(pdir,"NCBI37.3/NCBI37.3.gene.loc"), sep = "\t");colnames(gene_loc_37) <- c("entrezid", "chr", "start", "end","strand", "GN");magma_score_hg19 <- fread(fs::path(pdir,paste0("out/step2/",trait,"_tab.genes.out")), sep="\t", header = TRUE);magma_score_hg19_GN <- merge(gene_loc_37, magma_score_hg19, by.x = "entrezid", by.y = "GENE");scDRS_Input_magma <- magma_score_hg19_GN[,c("GN", "CHR", "START", "STOP", "NSNPS", "NPARAM", "N", "ZSTAT", "P")];fwrite(as_tibble(scDRS_Input_magma)%>%dplyr::select(GN,'AS_finngen_strict'=ZSTAT),file = fs::path(pdir,"gs_file",paste0(trait,"_","scDRS_input_magma.tsv")),sep = "\t")' > ./magma_v1.10/Magma_entrez_to_symbol.R;export R_X=4.1;Rscript ./magma_v1.10/Magma_entrez_to_symbol.R ./magma_v1.10 AS_finngen_strict
awk -v OFS="\t" '$1=$1' ./magma_v1.10/out/step2/AS_immunochip_removed_MHC_24MB_to_35MB.genes.out > ./magma_v1.10/out/step2/AS_immunochip_removed_MHC_24MB_to_35MB_tab.genes.out;echo 'library(data.table);library(fs);library(tidyverse);args = commandArgs(trailingOnly=TRUE);pdir<-args[1];trait<-args[2];gene_loc_37 <- fread(fs::path(pdir,"NCBI37.3/NCBI37.3.gene.loc"), sep = "\t");colnames(gene_loc_37) <- c("entrezid", "chr", "start", "end","strand", "GN");magma_score_hg19 <- fread(fs::path(pdir,paste0("out/step2/",trait,"_tab.genes.out")), sep="\t", header = TRUE);magma_score_hg19_GN <- merge(gene_loc_37, magma_score_hg19, by.x = "entrezid", by.y = "GENE");scDRS_Input_magma <- magma_score_hg19_GN[,c("GN", "CHR", "START", "STOP", "NSNPS", "NPARAM", "N", "ZSTAT", "P")];fwrite(as_tibble(scDRS_Input_magma)%>%dplyr::select(GN,'AS_immunochip_removed_MHC_24MB_to_35MB'=ZSTAT),file = fs::path(pdir,"gs_file",paste0(trait,"_","scDRS_input_magma.tsv")),sep = "\t")' > ./magma_v1.10/Magma_entrez_to_symbol.R;export R_X=4.1;Rscript ./magma_v1.10/Magma_entrez_to_symbol.R ./magma_v1.10 AS_immunochip_removed_MHC_24MB_to_35MB
awk -v OFS="\t" '$1=$1' ./magma_v1.10/out/step2/AS_panUK.genes.out > ./magma_v1.10/out/step2/AS_panUK_tab.genes.out;echo 'library(data.table);library(fs);library(tidyverse);args = commandArgs(trailingOnly=TRUE);pdir<-args[1];trait<-args[2];gene_loc_37 <- fread(fs::path(pdir,"NCBI37.3/NCBI37.3.gene.loc"), sep = "\t");colnames(gene_loc_37) <- c("entrezid", "chr", "start", "end","strand", "GN");magma_score_hg19 <- fread(fs::path(pdir,paste0("out/step2/",trait,"_tab.genes.out")), sep="\t", header = TRUE);magma_score_hg19_GN <- merge(gene_loc_37, magma_score_hg19, by.x = "entrezid", by.y = "GENE");scDRS_Input_magma <- magma_score_hg19_GN[,c("GN", "CHR", "START", "STOP", "NSNPS", "NPARAM", "N", "ZSTAT", "P")];fwrite(as_tibble(scDRS_Input_magma)%>%dplyr::select(GN,'AS_panUK'=ZSTAT),file = fs::path(pdir,"gs_file",paste0(trait,"_","scDRS_input_magma.tsv")),sep = "\t")' > ./magma_v1.10/Magma_entrez_to_symbol.R;export R_X=4.1;Rscript ./magma_v1.10/Magma_entrez_to_symbol.R ./magma_v1.10 AS_panUK
awk -v OFS="\t" '$1=$1' ./magma_v1.10/out/step2/AdultOnset.genes.out > ./magma_v1.10/out/step2/AdultOnset_tab.genes.out;echo 'library(data.table);library(fs);library(tidyverse);args = commandArgs(trailingOnly=TRUE);pdir<-args[1];trait<-args[2];gene_loc_37 <- fread(fs::path(pdir,"NCBI37.3/NCBI37.3.gene.loc"), sep = "\t");colnames(gene_loc_37) <- c("entrezid", "chr", "start", "end","strand", "GN");magma_score_hg19 <- fread(fs::path(pdir,paste0("out/step2/",trait,"_tab.genes.out")), sep="\t", header = TRUE);magma_score_hg19_GN <- merge(gene_loc_37, magma_score_hg19, by.x = "entrezid", by.y = "GENE");scDRS_Input_magma <- magma_score_hg19_GN[,c("GN", "CHR", "START", "STOP", "NSNPS", "NPARAM", "N", "ZSTAT", "P")];fwrite(as_tibble(scDRS_Input_magma)%>%dplyr::select(GN,'AdultOnset'=ZSTAT),file = fs::path(pdir,"gs_file",paste0(trait,"_","scDRS_input_magma.tsv")),sep = "\t")' > ./magma_v1.10/Magma_entrez_to_symbol.R;export R_X=4.1;Rscript ./magma_v1.10/Magma_entrez_to_symbol.R ./magma_v1.10 AdultOnset
awk -v OFS="\t" '$1=$1' ./magma_v1.10/out/step2/AllergyEczema.genes.out > ./magma_v1.10/out/step2/AllergyEczema_tab.genes.out;echo 'library(data.table);library(fs);library(tidyverse);args = commandArgs(trailingOnly=TRUE);pdir<-args[1];trait<-args[2];gene_loc_37 <- fread(fs::path(pdir,"NCBI37.3/NCBI37.3.gene.loc"), sep = "\t");colnames(gene_loc_37) <- c("entrezid", "chr", "start", "end","strand", "GN");magma_score_hg19 <- fread(fs::path(pdir,paste0("out/step2/",trait,"_tab.genes.out")), sep="\t", header = TRUE);magma_score_hg19_GN <- merge(gene_loc_37, magma_score_hg19, by.x = "entrezid", by.y = "GENE");scDRS_Input_magma <- magma_score_hg19_GN[,c("GN", "CHR", "START", "STOP", "NSNPS", "NPARAM", "N", "ZSTAT", "P")];fwrite(as_tibble(scDRS_Input_magma)%>%dplyr::select(GN,'AllergyEczema'=ZSTAT),file = fs::path(pdir,"gs_file",paste0(trait,"_","scDRS_input_magma.tsv")),sep = "\t")' > ./magma_v1.10/Magma_entrez_to_symbol.R;export R_X=4.1;Rscript ./magma_v1.10/Magma_entrez_to_symbol.R ./magma_v1.10 AllergyEczema
awk -v OFS="\t" '$1=$1' ./magma_v1.10/out/step2/Alzheimer.genes.out > ./magma_v1.10/out/step2/Alzheimer_tab.genes.out;echo 'library(data.table);library(fs);library(tidyverse);args = commandArgs(trailingOnly=TRUE);pdir<-args[1];trait<-args[2];gene_loc_37 <- fread(fs::path(pdir,"NCBI37.3/NCBI37.3.gene.loc"), sep = "\t");colnames(gene_loc_37) <- c("entrezid", "chr", "start", "end","strand", "GN");magma_score_hg19 <- fread(fs::path(pdir,paste0("out/step2/",trait,"_tab.genes.out")), sep="\t", header = TRUE);magma_score_hg19_GN <- merge(gene_loc_37, magma_score_hg19, by.x = "entrezid", by.y = "GENE");scDRS_Input_magma <- magma_score_hg19_GN[,c("GN", "CHR", "START", "STOP", "NSNPS", "NPARAM", "N", "ZSTAT", "P")];fwrite(as_tibble(scDRS_Input_magma)%>%dplyr::select(GN,'Alzheimer'=ZSTAT),file = fs::path(pdir,"gs_file",paste0(trait,"_","scDRS_input_magma.tsv")),sep = "\t")' > ./magma_v1.10/Magma_entrez_to_symbol.R;export R_X=4.1;Rscript ./magma_v1.10/Magma_entrez_to_symbol.R ./magma_v1.10 Alzheimer
awk -v OFS="\t" '$1=$1' ./magma_v1.10/out/step2/Arthritis.genes.out > ./magma_v1.10/out/step2/Arthritis_tab.genes.out;echo 'library(data.table);library(fs);library(tidyverse);args = commandArgs(trailingOnly=TRUE);pdir<-args[1];trait<-args[2];gene_loc_37 <- fread(fs::path(pdir,"NCBI37.3/NCBI37.3.gene.loc"), sep = "\t");colnames(gene_loc_37) <- c("entrezid", "chr", "start", "end","strand", "GN");magma_score_hg19 <- fread(fs::path(pdir,paste0("out/step2/",trait,"_tab.genes.out")), sep="\t", header = TRUE);magma_score_hg19_GN <- merge(gene_loc_37, magma_score_hg19, by.x = "entrezid", by.y = "GENE");scDRS_Input_magma <- magma_score_hg19_GN[,c("GN", "CHR", "START", "STOP", "NSNPS", "NPARAM", "N", "ZSTAT", "P")];fwrite(as_tibble(scDRS_Input_magma)%>%dplyr::select(GN,'Arthritis'=ZSTAT),file = fs::path(pdir,"gs_file",paste0(trait,"_","scDRS_input_magma.tsv")),sep = "\t")' > ./magma_v1.10/Magma_entrez_to_symbol.R;export R_X=4.1;Rscript ./magma_v1.10/Magma_entrez_to_symbol.R ./magma_v1.10 Arthritis
awk -v OFS="\t" '$1=$1' ./magma_v1.10/out/step2/ChildOnset.genes.out > ./magma_v1.10/out/step2/ChildOnset_tab.genes.out;echo 'library(data.table);library(fs);library(tidyverse);args = commandArgs(trailingOnly=TRUE);pdir<-args[1];trait<-args[2];gene_loc_37 <- fread(fs::path(pdir,"NCBI37.3/NCBI37.3.gene.loc"), sep = "\t");colnames(gene_loc_37) <- c("entrezid", "chr", "start", "end","strand", "GN");magma_score_hg19 <- fread(fs::path(pdir,paste0("out/step2/",trait,"_tab.genes.out")), sep="\t", header = TRUE);magma_score_hg19_GN <- merge(gene_loc_37, magma_score_hg19, by.x = "entrezid", by.y = "GENE");scDRS_Input_magma <- magma_score_hg19_GN[,c("GN", "CHR", "START", "STOP", "NSNPS", "NPARAM", "N", "ZSTAT", "P")];fwrite(as_tibble(scDRS_Input_magma)%>%dplyr::select(GN,'ChildOnset'=ZSTAT),file = fs::path(pdir,"gs_file",paste0(trait,"_","scDRS_input_magma.tsv")),sep = "\t")' > ./magma_v1.10/Magma_entrez_to_symbol.R;export R_X=4.1;Rscript ./magma_v1.10/Magma_entrez_to_symbol.R ./magma_v1.10 ChildOnset
awk -v OFS="\t" '$1=$1' ./magma_v1.10/out/step2/Crohns_Disease.genes.out > ./magma_v1.10/out/step2/Crohns_Disease_tab.genes.out;echo 'library(data.table);library(fs);library(tidyverse);args = commandArgs(trailingOnly=TRUE);pdir<-args[1];trait<-args[2];gene_loc_37 <- fread(fs::path(pdir,"NCBI37.3/NCBI37.3.gene.loc"), sep = "\t");colnames(gene_loc_37) <- c("entrezid", "chr", "start", "end","strand", "GN");magma_score_hg19 <- fread(fs::path(pdir,paste0("out/step2/",trait,"_tab.genes.out")), sep="\t", header = TRUE);magma_score_hg19_GN <- merge(gene_loc_37, magma_score_hg19, by.x = "entrezid", by.y = "GENE");scDRS_Input_magma <- magma_score_hg19_GN[,c("GN", "CHR", "START", "STOP", "NSNPS", "NPARAM", "N", "ZSTAT", "P")];fwrite(as_tibble(scDRS_Input_magma)%>%dplyr::select(GN,'Crohns_Disease'=ZSTAT),file = fs::path(pdir,"gs_file",paste0(trait,"_","scDRS_input_magma.tsv")),sep = "\t")' > ./magma_v1.10/Magma_entrez_to_symbol.R;export R_X=4.1;Rscript ./magma_v1.10/Magma_entrez_to_symbol.R ./magma_v1.10 Crohns_Disease
awk -v OFS="\t" '$1=$1' ./magma_v1.10/out/step2/Height.genes.out > ./magma_v1.10/out/step2/Height_tab.genes.out;echo 'library(data.table);library(fs);library(tidyverse);args = commandArgs(trailingOnly=TRUE);pdir<-args[1];trait<-args[2];gene_loc_37 <- fread(fs::path(pdir,"NCBI37.3/NCBI37.3.gene.loc"), sep = "\t");colnames(gene_loc_37) <- c("entrezid", "chr", "start", "end","strand", "GN");magma_score_hg19 <- fread(fs::path(pdir,paste0("out/step2/",trait,"_tab.genes.out")), sep="\t", header = TRUE);magma_score_hg19_GN <- merge(gene_loc_37, magma_score_hg19, by.x = "entrezid", by.y = "GENE");scDRS_Input_magma <- magma_score_hg19_GN[,c("GN", "CHR", "START", "STOP", "NSNPS", "NPARAM", "N", "ZSTAT", "P")];fwrite(as_tibble(scDRS_Input_magma)%>%dplyr::select(GN,'Height'=ZSTAT),file = fs::path(pdir,"gs_file",paste0(trait,"_","scDRS_input_magma.tsv")),sep = "\t")' > ./magma_v1.10/Magma_entrez_to_symbol.R;export R_X=4.1;Rscript ./magma_v1.10/Magma_entrez_to_symbol.R ./magma_v1.10 Height
awk -v OFS="\t" '$1=$1' ./magma_v1.10/out/step2/IBD.genes.out > ./magma_v1.10/out/step2/IBD_tab.genes.out;echo 'library(data.table);library(fs);library(tidyverse);args = commandArgs(trailingOnly=TRUE);pdir<-args[1];trait<-args[2];gene_loc_37 <- fread(fs::path(pdir,"NCBI37.3/NCBI37.3.gene.loc"), sep = "\t");colnames(gene_loc_37) <- c("entrezid", "chr", "start", "end","strand", "GN");magma_score_hg19 <- fread(fs::path(pdir,paste0("out/step2/",trait,"_tab.genes.out")), sep="\t", header = TRUE);magma_score_hg19_GN <- merge(gene_loc_37, magma_score_hg19, by.x = "entrezid", by.y = "GENE");scDRS_Input_magma <- magma_score_hg19_GN[,c("GN", "CHR", "START", "STOP", "NSNPS", "NPARAM", "N", "ZSTAT", "P")];fwrite(as_tibble(scDRS_Input_magma)%>%dplyr::select(GN,'IBD'=ZSTAT),file = fs::path(pdir,"gs_file",paste0(trait,"_","scDRS_input_magma.tsv")),sep = "\t")' > ./magma_v1.10/Magma_entrez_to_symbol.R;export R_X=4.1;Rscript ./magma_v1.10/Magma_entrez_to_symbol.R ./magma_v1.10 IBD
awk -v OFS="\t" '$1=$1' ./magma_v1.10/out/step2/Lupus.genes.out > ./magma_v1.10/out/step2/Lupus_tab.genes.out;echo 'library(data.table);library(fs);library(tidyverse);args = commandArgs(trailingOnly=TRUE);pdir<-args[1];trait<-args[2];gene_loc_37 <- fread(fs::path(pdir,"NCBI37.3/NCBI37.3.gene.loc"), sep = "\t");colnames(gene_loc_37) <- c("entrezid", "chr", "start", "end","strand", "GN");magma_score_hg19 <- fread(fs::path(pdir,paste0("out/step2/",trait,"_tab.genes.out")), sep="\t", header = TRUE);magma_score_hg19_GN <- merge(gene_loc_37, magma_score_hg19, by.x = "entrezid", by.y = "GENE");scDRS_Input_magma <- magma_score_hg19_GN[,c("GN", "CHR", "START", "STOP", "NSNPS", "NPARAM", "N", "ZSTAT", "P")];fwrite(as_tibble(scDRS_Input_magma)%>%dplyr::select(GN,'Lupus'=ZSTAT),file = fs::path(pdir,"gs_file",paste0(trait,"_","scDRS_input_magma.tsv")),sep = "\t")' > ./magma_v1.10/Magma_entrez_to_symbol.R;export R_X=4.1;Rscript ./magma_v1.10/Magma_entrez_to_symbol.R ./magma_v1.10 Lupus
awk -v OFS="\t" '$1=$1' ./magma_v1.10/out/step2/New_Lupus.genes.out > ./magma_v1.10/out/step2/New_Lupus_tab.genes.out;echo 'library(data.table);library(fs);library(tidyverse);args = commandArgs(trailingOnly=TRUE);pdir<-args[1];trait<-args[2];gene_loc_37 <- fread(fs::path(pdir,"NCBI37.3/NCBI37.3.gene.loc"), sep = "\t");colnames(gene_loc_37) <- c("entrezid", "chr", "start", "end","strand", "GN");magma_score_hg19 <- fread(fs::path(pdir,paste0("out/step2/",trait,"_tab.genes.out")), sep="\t", header = TRUE);magma_score_hg19_GN <- merge(gene_loc_37, magma_score_hg19, by.x = "entrezid", by.y = "GENE");scDRS_Input_magma <- magma_score_hg19_GN[,c("GN", "CHR", "START", "STOP", "NSNPS", "NPARAM", "N", "ZSTAT", "P")];fwrite(as_tibble(scDRS_Input_magma)%>%dplyr::select(GN,'New_Lupus'=ZSTAT),file = fs::path(pdir,"gs_file",paste0(trait,"_","scDRS_input_magma.tsv")),sep = "\t")' > ./magma_v1.10/Magma_entrez_to_symbol.R;export R_X=4.1;Rscript ./magma_v1.10/Magma_entrez_to_symbol.R ./magma_v1.10 New_Lupus
awk -v OFS="\t" '$1=$1' ./magma_v1.10/out/step2/PBC.genes.out > ./magma_v1.10/out/step2/PBC_tab.genes.out;echo 'library(data.table);library(fs);library(tidyverse);args = commandArgs(trailingOnly=TRUE);pdir<-args[1];trait<-args[2];gene_loc_37 <- fread(fs::path(pdir,"NCBI37.3/NCBI37.3.gene.loc"), sep = "\t");colnames(gene_loc_37) <- c("entrezid", "chr", "start", "end","strand", "GN");magma_score_hg19 <- fread(fs::path(pdir,paste0("out/step2/",trait,"_tab.genes.out")), sep="\t", header = TRUE);magma_score_hg19_GN <- merge(gene_loc_37, magma_score_hg19, by.x = "entrezid", by.y = "GENE");scDRS_Input_magma <- magma_score_hg19_GN[,c("GN", "CHR", "START", "STOP", "NSNPS", "NPARAM", "N", "ZSTAT", "P")];fwrite(as_tibble(scDRS_Input_magma)%>%dplyr::select(GN,'PBC'=ZSTAT),file = fs::path(pdir,"gs_file",paste0(trait,"_","scDRS_input_magma.tsv")),sep = "\t")' > ./magma_v1.10/Magma_entrez_to_symbol.R;export R_X=4.1;Rscript ./magma_v1.10/Magma_entrez_to_symbol.R ./magma_v1.10 PBC
awk -v OFS="\t" '$1=$1' ./magma_v1.10/out/step2/UKBAsthma.genes.out > ./magma_v1.10/out/step2/UKBAsthma_tab.genes.out;echo 'library(data.table);library(fs);library(tidyverse);args = commandArgs(trailingOnly=TRUE);pdir<-args[1];trait<-args[2];gene_loc_37 <- fread(fs::path(pdir,"NCBI37.3/NCBI37.3.gene.loc"), sep = "\t");colnames(gene_loc_37) <- c("entrezid", "chr", "start", "end","strand", "GN");magma_score_hg19 <- fread(fs::path(pdir,paste0("out/step2/",trait,"_tab.genes.out")), sep="\t", header = TRUE);magma_score_hg19_GN <- merge(gene_loc_37, magma_score_hg19, by.x = "entrezid", by.y = "GENE");scDRS_Input_magma <- magma_score_hg19_GN[,c("GN", "CHR", "START", "STOP", "NSNPS", "NPARAM", "N", "ZSTAT", "P")];fwrite(as_tibble(scDRS_Input_magma)%>%dplyr::select(GN,'UKBAsthma'=ZSTAT),file = fs::path(pdir,"gs_file",paste0(trait,"_","scDRS_input_magma.tsv")),sep = "\t")' > ./magma_v1.10/Magma_entrez_to_symbol.R;export R_X=4.1;Rscript ./magma_v1.10/Magma_entrez_to_symbol.R ./magma_v1.10 UKBAsthma
awk -v OFS="\t" '$1=$1' ./magma_v1.10/out/step2/Ulcerative_Colitis.genes.out > ./magma_v1.10/out/step2/Ulcerative_Colitis_tab.genes.out;echo 'library(data.table);library(fs);library(tidyverse);args = commandArgs(trailingOnly=TRUE);pdir<-args[1];trait<-args[2];gene_loc_37 <- fread(fs::path(pdir,"NCBI37.3/NCBI37.3.gene.loc"), sep = "\t");colnames(gene_loc_37) <- c("entrezid", "chr", "start", "end","strand", "GN");magma_score_hg19 <- fread(fs::path(pdir,paste0("out/step2/",trait,"_tab.genes.out")), sep="\t", header = TRUE);magma_score_hg19_GN <- merge(gene_loc_37, magma_score_hg19, by.x = "entrezid", by.y = "GENE");scDRS_Input_magma <- magma_score_hg19_GN[,c("GN", "CHR", "START", "STOP", "NSNPS", "NPARAM", "N", "ZSTAT", "P")];fwrite(as_tibble(scDRS_Input_magma)%>%dplyr::select(GN,'Ulcerative_Colitis'=ZSTAT),file = fs::path(pdir,"gs_file",paste0(trait,"_","scDRS_input_magma.tsv")),sep = "\t")' > ./magma_v1.10/Magma_entrez_to_symbol.R;export R_X=4.1;Rscript ./magma_v1.10/Magma_entrez_to_symbol.R ./magma_v1.10 Ulcerative_Colitis


